---
interface Props {
  placeholder?: string;
  value?: string;
}

const { placeholder = "Buscar por equipo o competición...", value = "" } = Astro.props;
---

<div class="w-full">
  <div class="relative">
    <input
      type="text"
      id="search-input"
      placeholder={placeholder}
      value={value}
      class="w-full px-0 py-4 pl-10 border-0 border-b border-primary-300 bg-transparent focus:border-primary-500 outline-none transition-colors text-primary-900 placeholder-primary-400 font-normal text-base"
    />
    <svg
      class="absolute left-0 top-1/2 transform -translate-y-1/2 w-5 h-5 text-primary-400"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
      />
    </svg>
  </div>
</div>

<script>
  const searchInput = document.getElementById('search-input');
  if (searchInput) {
    const filterCards = () => {
      const searchTerm = searchInput.value.toLowerCase();
      const competitionFilter = document.getElementById('competition-filter')?.value || '';
      const cards = document.querySelectorAll('[data-match-card]');
      
      cards.forEach((card) => {
        const cardComp = card.getAttribute('data-competition') || '';
        const cardText = card.textContent.toLowerCase();
        const matchesSearch = !searchTerm || cardText.includes(searchTerm);
        const matchesCompetition = !competitionFilter || cardComp === competitionFilter;
        
        if (matchesSearch && matchesCompetition) {
          card.classList.remove('hidden');
        } else {
          card.classList.add('hidden');
        }
      });
      
      // Disparar evento personalizado para notificar cambios
      const event = new CustomEvent('filtersChanged');
      document.dispatchEvent(event);
    };
    
    searchInput.addEventListener('input', filterCards);
    
    // También filtrar cuando cambia el filtro de competición
    const competitionFilter = document.getElementById('competition-filter');
    if (competitionFilter) {
      competitionFilter.addEventListener('change', filterCards);
    }
  }
</script>

